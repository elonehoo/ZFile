var e=(e,t,l)=>new Promise(((n,a)=>{var o=e=>{try{r(l.next(e))}catch(t){a(t)}},i=e=>{try{r(l.throw(e))}catch(t){a(t)}},r=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,i);r((l=l.apply(e,t)).next())}));import{d as t,M as l,e as n,T as a,B as o,f as i,c as r}from"./index.14794468.js";import{f as s,i as c,s as u,u as d,m as f,g as m,h as p,k as v}from"./index.a4cb9473.js";import{ac as h,ad as g,ae as k,c as b,b as y,a5 as w,U as x,W as R,X as I,Z as C,af as F,ag as T,f as _,Y as A,aa as M,ab as L,ah as D,ai as j,a8 as N,aj as S,T as z,r as B,o as H,ak as P,al as U,a9 as $,S as E,i as V,j as O,u as q}from"./vendor.37e0cd1a.js";import{M as Z}from"./_utils.29a066cb.js";import{_ as G}from"./logo.1a86dcf3.js";function W(){const e=h();return[(t=0,l,n)=>{l.value=e.info({title:n,content:()=>g(k,{type:"line",percentage:t,"indicator-placement":"inside",processing:!0}),onClose:()=>{l.value=null}})},(e=0,t={},l)=>{const{autoClose:n=!1,duration:a=3e3}=t;l.value&&(l.value.content=()=>g(k,{type:"line",percentage:e,"indicator-placement":"inside",processing:100!==e}),l.value.meta=n?`close after ${a/1e3}s`:void 0)}]}var X=b({name:"FolderAdd",components:{AliIcon:t},setup(){const t=y(null),l=w(),[n,a]=W();let o=0;const i=new Map;return{folderAddRef:t,uploadFolder:t=>e(this,null,(function*(){var e;o++;const r=y();i.set(o,r);let u=new FormData;const d=null==(e=t.target)?void 0:e.files;let f,m=0;for(let t=0;t<d.length;t++)0!==d[t].size?(u.append("files",d[t],d[t].webkitRelativePath.split("/").join("!")),console.log("filename",d[t].webkitRelativePath)):m++;m&&l.warning(`${m} file(s)' size equal '0'`),n(0,r,`folders progress ${o}`),yield s(r,u,"/home",a).then((({status:e})=>{c(e)&&(a(100,{autoClose:!0},r),f=setTimeout((()=>{var e;clearTimeout(f),f=null,r.value&&(null==(e=r.value)||e.destroy(),i.delete(o))}),3e3))})).catch((()=>{var e;r.value&&(null==(e=r.value)||e.destroy(),i.delete(o))})).finally((()=>{t.target.value="",u=null}))}))}}});X.render=function(e,t,l,n,a,o){const i=x("AliIcon");return R(),I("div",null,[C("input",{class:"absolute z-1 block w-full h-full cursor-pointer overflow-hidden indent-3xl",type:"file",multiple:!0,title:"folder-add",webkitdirectory:"",ref:"folderAddRef",onChange:t[1]||(t[1]=(...t)=>e.uploadFolder&&e.uploadFolder(...t))},null,544),C(i,{class:"relative icon dark:text-true-gray-200 !text-xl cursor-pointer",code:"folder-add"})])};var Y=b({name:"FileAdd",components:{AliIcon:t},setup(){const e=y(null),t=w();let l=0;const n=new Map,[a,o]=W();return{fileAddRef:e,uploadFiles:e=>{var i;l++;const r=y();n.set(l,r);let u=new FormData;const d=null==(i=e.target)?void 0:i.files;let f,m=0;for(let t=0;t<d.length;t++)0!==d[t].size?u.append("files",d[t]):m++;m&&t.warning(`${m} file(s)' size equal '0'`),a(0,r,`file progress ${l}`),s(r,u,"/home",o).then((({status:e})=>{var a;c(e)?(o(100,{autoClose:!0},r),f=setTimeout((()=>{var e;clearTimeout(f),f=null,r.value&&(null==(e=r.value)||e.destroy(),n.delete(l))}),3e3)):(t.error("未知异常"),r.value&&(null==(a=r.value)||a.destroy(),n.delete(l)))})).catch((()=>{var e;t.error("请求异常"),r.value&&(null==(e=r.value)||e.destroy(),n.delete(l))})).finally((()=>{e.target.value="",u=null}))}}}});Y.render=function(e,t,l,n,a,o){const i=x("AliIcon");return R(),I("div",null,[C("input",{class:"absolute z-1 block w-full h-full cursor-pointer overflow-hidden indent-3xl",type:"file",multiple:!0,title:"file-add",ref:"fileAddRef",onChange:t[1]||(t[1]=(...t)=>e.uploadFiles&&e.uploadFiles(...t))},null,544),C(i,{class:"relative icon dark:text-true-gray-200 !text-xl cursor-pointer",code:"file-add"})])};var J=b({name:"LeftMenu",components:{Menu:l,MenuItem:n,AliIcon:t,FolderAdd:X,FileAdd:Y},props:{dom:{type:Object,default:null}},setup(t){const l=F(t,"dom"),{isFullscreen:n,enter:a}=T(l),o=_();return{MenuMode:Z,navItems:[{code:"quanping",activeCode:"xiaoping",active:n,key:1,title:"fullscreen",click:()=>{a()}},{code:"xiazai",key:4,title:"download"},{code:"lianjie",key:5,title:"link"}],github:"https://github.com/xiaoxunyao/ZFile",toSignOut:()=>e(this,null,(function*(){const{status:e}=yield u();c(e)&&o.push("/login")}))}}});const K=C("img",{src:G,class:"w-20"},null,-1),Q={class:"nav-btn"},ee={class:"nav-btn"};J.render=function(e,t,l,n,a,o){const i=x("AliIcon"),r=x("MenuItem"),s=x("FolderAdd"),c=x("FileAdd"),u=x("Menu");return R(),I("div",null,[C("a",{href:e.github,class:"block relative left-2 w-18 h-18"},[K],8,["href"]),C(u,{mode:e.MenuMode.VERTICAL,class:"ml-6 mt-8"},{default:A((()=>[(R(!0),I(M,null,L(e.navItems,(e=>(R(),I(r,{key:e.key,title:e.title,onclick:e.click},{default:A((()=>[C("div",Q,[C(i,{class:"icon dark:text-true-gray-200 !text-xl",code:e.code},null,8,["code"])])])),_:2},1032,["title","onclick"])))),128)),C(r,null,{default:A((()=>[C(s,{class:"nav-btn relative cursor-pointer overflow-hidden"})])),_:1}),C(r,null,{default:A((()=>[C(c,{class:"nav-btn relative cursor-pointer overflow-hidden"})])),_:1}),C(r,null,{default:A((()=>[C("div",ee,[C(i,{class:"icon dark:text-true-gray-200 !text-xl",code:"exit",title:"sign out",onClick:e.toSignOut},null,8,["onClick"])])])),_:1})])),_:1},8,["mode"])])};const te=new Set(["bash_logout","bash_profile","bashrc","java","apk","xls","excel","txt","unknow","shell","debianos","avi","doc","jpg","mp3","mp4","png","psd","rar","zip","md","css","html","rpm","jar","less","Directory","exe","ppt","word","cs","app","cpp","rb","py","r","oc","rs","go","sql","scala","swift","js"]);var le=b({name:"FileTableItem",components:{AliIcon:t},props:{fileInfo:{type:Object,default:()=>({fileType:"unknow",fileName:"--",fileSize:"--",dateTime:"--"})},isFocus:{type:Boolean,default:!1},onBlur:{type:Function,default:null}},emits:["update:modelValue"],setup:(e,{emit:t})=>({activeRef:y(!1),codeShow:te.has(e.fileInfo.fileType||"")?e.fileInfo.fileType:"unknow",changeInput:e=>{t("update:modelValue",e)}})});const ne=S();D("data-v-316e3566");const ae={class:"\r\n\t\t\th-12\r\n\t\t\tw-full\r\n\t\t\tflex\r\n\t\t\ttransition-colors\r\n\t\t\ttext-left\r\n\t\t\tcursor-pointer\r\n\t\t\tbg-light-50\r\n\t\t\tdark:bg-blue-gray-600\r\n\t\t",hover:"bg-blue-50 dark:bg-blue-gray-700"},oe={class:"file-item-name pl-12 dark:text-warm-gray-300"},ie={class:"file-item-time hidden lg:block indent-sm dark:text-warm-gray-300"},re={class:"file-item-size indent-sm dark:text-warm-gray-300"};j();const se=ne(((e,t,l,n,a,o)=>{const i=x("AliIcon"),r=x("n-input");return R(),I("div",ae,[C("div",oe,[C(i,{code:e.codeShow,class:"!text-3xl mr-8"},null,8,["code"]),e.isFocus?(R(),I(r,{key:1,class:"whitespace-nowrap overflow-ellipsis overflow-hidden max-w-60 lg:w-auto","on-input":e.changeInput,"on-blur":e.onBlur,value:e.fileInfo.fileName,placeholder:"",autofocus:!0},null,8,["on-input","on-blur","value"])):(R(),I("span",{key:0,class:"whitespace-nowrap overflow-ellipsis overflow-hidden w-28 lg:w-auto",title:e.fileInfo.fileName},N(e.fileInfo.fileName),9,["title"]))]),C("div",ie,N(e.fileInfo.dateTime),1),C("div",re,N(e.fileInfo.fileSize),1)])}));le.render=se,le.__scopeId="data-v-316e3566";var ce=b({name:"FileTable",components:{FileTableItem:le},inheritAttrs:!1,props:{fileList:{type:Array,default:null}},setup(t){const l=y(),n=y(),a=z(),{t:o}=d(),i=_(),r=y(-9999),s=y(!1),c=B({}),u=y(!1),v=(e,a)=>{if(l.value&&l.value.hide(),n.value&&n.value.hide(),s.value=!1,Number.isInteger(a)||a){const e=t.fileList&&t.fileList[a];"Directory"===e.fileType&&i.push(f(i.currentRoute.value.fullPath)+e.fileName)}};return H((()=>{document.addEventListener("click",v),document.addEventListener("contextmenu",v)})),P((()=>{document.removeEventListener("click",v),document.removeEventListener("contextmenu",v)})),{menuRef:l,controlRef:n,controlHide:e=>{e.preventDefault(),e.stopPropagation(),n.value&&n.value.show({top:e.y,left:e.x}),l.value&&l.value.hide()},fileRefHide:(e,t)=>{e.preventDefault(),e.stopPropagation(),l.value&&l.value.show({top:e.y,left:e.x}),n.value&&n.value.hide(),r.value=t,s.value=!0},hideClick:v,openDir:()=>{const e=t.fileList&&t.fileList[r.value];"Directory"===e.fileType&&i.push(f(i.currentRoute.value.fullPath)+e.fileName)},downLoad:()=>e(this,null,(function*(){console.log("====== download start ===============");const e=t.fileList&&t.fileList[r.value];if("Directory"===e.fileType)return;const l=yield m(p(i.currentRoute.value.path)+e.fileName);let n=document.createElement("a");n.href=URL.createObjectURL(l),n.download=null==e?void 0:e.fileName,n.click(),n=null})),t:o,activeRef:s,curFileRef:r,mkdir:e=>{u.value=!0,c.fileName="Directory"===e?"新建文件夹":"新建文件";const t=c.fileName;if(!e)if(/.*\..*/.test(t)){const l=t.split(".");e=l[l.length-1]}else e="unknow";c.fileType=e},deleteDir:()=>e(this,null,(function*(){a.commit("fileSys/deleteDirMutation")})),fileInfoRef:c,mkInfoRef:u,blurToMkpath:()=>{u.value=!1,a.dispatch("fileSys/mkdirAction",{address:p(i.currentRoute.value.path),fileName:c.fileName})}}}});const ue=$("新建文件夹"),de=$("新建文件"),fe=$("刷新"),me=$("打开"),pe=$("删除"),ve=$("下载"),he=$("生成直链"),ge={class:"head-name pl-12 hover:bg-blue-50 dark:hover:bg-blue-gray-600"},ke={class:"head-time hidden lg:block indent-sm hover:bg-blue-50 dark:hover:bg-blue-gray-600"},be={class:"head-size indent-sm hover:bg-blue-50 dark:hover:bg-blue-gray-600"},ye={class:"file-table-items h-full overflow-scroll overflow-x-hidden sun-scroll"};ce.render=function(e,t,l,n,a,o){const i=x("v-contextmenu-item"),r=x("v-contextmenu-divider"),s=x("v-contextmenu"),c=x("FileTableItem");return R(),I(M,null,[C(s,{ref:"controlRef"},{default:A((()=>[C(i,{class:"text-center",onClick:t[1]||(t[1]=()=>{e.mkdir("Directory")})},{default:A((()=>[ue])),_:1}),C(r),C(i,{class:"text-center"},{default:A((()=>[de])),_:1}),C(r),C(i,{class:"text-center"},{default:A((()=>[fe])),_:1})])),_:1},512),C(s,{ref:"menuRef"},{default:A((()=>[C(i,{class:"text-center",onClick:e.openDir},{default:A((()=>[me])),_:1},8,["onClick"]),C(r),C(i,{class:"text-center",onClick:e.deleteDir},{default:A((()=>[pe])),_:1},8,["onClick"]),C(r),C(i,{class:"text-center",onClick:e.downLoad},{default:A((()=>[ve])),_:1},8,["onClick"]),C(r),C(i,{class:"text-center"},{default:A((()=>[he])),_:1})])),_:1},512),C("div",{class:["file-table",e.$attrs.class]},[C("div",{class:"\n\t\t\t\tfile-table-head\n\t\t\t\ttext-warm-gray-400\n\t\t\t\tdark:text-light\n\t\t\t\tborder-b-[0.5px] border-gray-200\n\t\t\t\tdark:border-gray-400\n\t\t\t\ttext-md\n\t\t\t\tfont-semibold\n\t\t\t",onContextmenu:t[2]||(t[2]=(...t)=>e.controlHide&&e.controlHide(...t)),onClick:t[3]||(t[3]=(...t)=>e.hideClick&&e.hideClick(...t))},[C("div",ge,N(e.t("tablle.header.name")),1),C("div",ke,N(e.t("tablle.header.time")),1),C("div",be,N(e.t("tablle.header.size")),1)],32),C("div",ye,[e.mkInfoRef?(R(),I(c,{key:0,"is-focus":!0,"on-blur":e.blurToMkpath,"file-info":e.fileInfoRef,modelValue:e.fileInfoRef.fileName,"onUpdate:modelValue":t[4]||(t[4]=t=>e.fileInfoRef.fileName=t)},null,8,["on-blur","file-info","modelValue"])):U("",!0),(R(!0),I(M,null,L(e.fileList,((t,l)=>(R(),I(c,{key:t.id,"file-info":t,class:{"!bg-blue-50 !dark:bg-blue-gray-700":e.activeRef&&e.curFileRef===l},onContextmenu:t=>{e.fileRefHide(t,l)},onClick:t=>{e.hideClick(t,l)}},null,8,["file-info","class","onContextmenu","onClick"])))),128)),C("div",{class:"h-full bg-light-50 dark:bg-blue-gray-600 transition-colors",onContextmenu:t[5]||(t[5]=(...t)=>e.controlHide&&e.controlHide(...t)),onClick:t[6]||(t[6]=(...t)=>e.hideClick&&e.hideClick(...t))},null,32)])],2)],64)};var we=b({name:"Main",components:{AliIcon:t,Translate:a,BreadItem:o,Breadcrumb:i,ToggleMode:r,FileTable:ce,LeftMenu:J},setup(){var t;const l=y(null),n=y(!1),a=y(!1),i=_(),r=z(),{isFullscreen:s,exit:c}=T(l),u=y([]),d=E((()=>r.getters["fileSys/curDirGetter"])),f=w(),m=null==(t=V(v))?void 0:t.smallScreen;O((()=>i.currentRoute.value.path),(()=>e(this,null,(function*(){n.value=!0;const e=yield r.dispatch("fileSys/checkDirAction",i.currentRoute.value.path.replace(/^\/main(\/)?/,"")).catch((t=>{console.error(t),f.error(e)})).finally((()=>{n.value=!1}));let t=q(i.currentRoute).params.path;t=""===t?"/":t;const l="string"==typeof t?[t]:t;u.value=l}))),{immediate:!0});return{fullRef:l,isFullscreen:s,fileHistory:[{code:"left",key:6,click:()=>{/^\/main(\/)?$/.test(i.currentRoute.value.path)||i.back()}},{code:"right",key:7,click:()=>{i.forward()}}],BreadItem:o,exit:c,pathRef:u,baseUrl:"/main/",fileList:d,showModal:n,smallScreen:m,active:a,openDrawer:()=>{a.value=!0}}}});const xe={id:"main",class:"\n\t\t\tw-screen\n\t\t\th-screen\n\t\t\tbg-blue-50\n\t\t\tdark:bg-gray-800\n\t\t\tflex\n\t\t\toverflow-hidden\n\t\t\ttransition-colors\n\t\t\tduration-200\n\t\t"},Re={class:"h-[4.5rem] w-full flex items-center overflow-hidden"},Ie={class:"flex items-center flex-1 text-left ml-8"},Ce=$("右"),Fe=$(" 《斯通纳》是美国作家约翰·威廉姆斯在 1965 年出版的小说。 "),Te={class:"flex-1 text-right flex justify-end items-center pr-2 lg:pr-8"},_e={class:"file-main w-full pb-2 pl-0 lg:pl-6"},Ae={class:"file-body w-full h-full rounded-0 lg:rounded-tl-3xl overflow-hidden"};we.render=function(e,t,l,n,a,o){const i=x("LeftMenu"),r=x("n-spin"),s=x("n-modal"),c=x("AliIcon"),u=x("n-button"),d=x("n-drawer-content"),f=x("n-drawer"),m=x("router-link"),p=x("BreadItem"),v=x("Breadcrumb"),h=x("ToggleMode"),g=x("Translate"),k=x("FileTable"),b=x("n-notification-provider");return R(),I("div",xe,[C(b,null,{default:A((()=>[C(i,{class:"hidden lg:block min-w-[5rem] h-screen overflow-hidden",dom:e.fullRef},null,8,["dom"]),C("div",{class:["w-full h-screen",{"bg-blue-50 dark:bg-gray-800":e.isFullscreen}],ref:"fullRef"},[C(s,{show:e.showModal},{default:A((()=>[C(r,{class:"bg-transparent text-blue-400 shadow-none",size:"large"})])),_:1},8,["show"]),C("nav",Re,[C("div",Ie,[e.smallScreen?(R(),I(M,{key:1},[C(u,{onClick:e.openDrawer},{default:A((()=>[Ce])),_:1},8,["onClick"]),C(f,{show:e.active,"onUpdate:show":t[1]||(t[1]=t=>e.active=t),width:200},{default:A((()=>[C(d,{title:"斯通纳"},{default:A((()=>[Fe])),_:1})])),_:1},8,["show"])],64)):(R(!0),I(M,{key:0},L(e.fileHistory,(e=>(R(),I(c,{class:"\n\t\t\t\t\t\t\t\t\ticon\n\t\t\t\t\t\t\t\t\tcursor-pointer\n\t\t\t\t\t\t\t\t\t!text-xl\n\t\t\t\t\t\t\t\t\t!inline-block\n\t\t\t\t\t\t\t\t\tfont-bold\n\t\t\t\t\t\t\t\t\talign-bottom\n\t\t\t\t\t\t\t\t\ttext-warm-gray-500\n\t\t\t\t\t\t\t\t\thover:text-warm-gray-900\n\t\t\t\t\t\t\t\t\tdark:text-true-gray-200 dark:text-true-gray-50\n\t\t\t\t\t\t\t\t\ttransform-gpu\n\t\t\t\t\t\t\t\t\ttransition-all\n\t\t\t\t\t\t\t\t\thover:scale-110\n\t\t\t\t\t\t\t\t",onClick:e.click,code:e.code,key:e.key},null,8,["onClick","code"])))),128)),C(v,{class:"ml-4"},{default:A((()=>[(R(!0),I(M,null,L(e.pathRef,((t,l)=>(R(),I(p,{key:t,class:"dark:text-true-gray-200"},{default:A((()=>[l<e.pathRef.length-1?(R(),I(m,{key:0,to:e.baseUrl+e.pathRef.slice(0,l+1).join("/")},{default:A((()=>[$(N(t),1)])),_:2},1032,["to"])):(R(),I(M,{key:1},[$(N(t),1)],64))])),_:2},1024)))),128))])),_:1})]),C("div",Te,[e.isFullscreen?(R(),I(c,{key:0,code:"xiaoping",class:"\n\t\t\t\t\t\t\t\tdark:text-white\n\t\t\t\t\t\t\t\tmr-8\n\t\t\t\t\t\t\t\t!text-2xl\n\t\t\t\t\t\t\t\tcursor-pointer\n\t\t\t\t\t\t\t\ttransition-transform\n\t\t\t\t\t\t\t\ttransform-gpu\n\t\t\t\t\t\t\t\thover:scale-110\n\t\t\t\t\t\t\t",onClick:e.exit},null,8,["onClick"])):U("",!0),C(h,{class:"pr-2 lg:mr-8"}),C(g)])]),C("div",_e,[C("div",Ae,[C(k,{class:"transition-colors bg-white dark:bg-gray-700 overflow-hidden","file-list":e.fileList},null,8,["file-list"])])])],2)])),_:1})])};export default we;
